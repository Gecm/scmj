{"version":3,"sources":["History.js"],"names":["cc","Class","extends","Component","properties","HistoryItemPrefab","default","type","Prefab","_history","_viewlist","_content","_viewitemTemp","_historyData","_curRoomInfo","_emptyTip","onLoad","node","getChildByName","active","find","children","removeChild","addClickEvent","target","component","handler","eventHandler","EventHandler","clickEvents","getComponent","Button","push","onBtnBackClicked","initRoomHistoryList","onBtnHistoryClicked","self","vv","userMgr","getHistoryList","data","sort","a","b","time","i","length","j","s","seats","name","Buffer","toString","dateFormat","date","Date","datetime","year","getFullYear","month","getMonth","day","getDate","h","getHours","m","getMinutes","getSeconds","format","getViewItem","idx","titleId","Label","string","id","btnOp","info","score","shrinkContent","initGameHistoryList","roomInfo","create_time","result","JSON","parse","index","content","childrenCount","instantiate","addChild","num","lastOne","getGameListOfRoom","getGamesOfRoom","uuid","getDetailOfGame","roomUUID","base_info","action_records","gameNetMgr","prepareReplay","replayMgr","init","director","loadScene","onViewItemClicked","event","console","log","onBtnOpClicked","parent"],"mappings":"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","file":"History.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        HistoryItemPrefab:{\r\n            default:null,\r\n            type:cc.Prefab,\r\n        },\r\n        // foo: {\r\n        //    default: null,\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        _history:null,\r\n        _viewlist:null,\r\n        _content:null,\r\n        _viewitemTemp:null,\r\n        _historyData:null,\r\n        _curRoomInfo:null,\r\n        _emptyTip:null,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._history = this.node.getChildByName(\"history\");\r\n        this._history.active = false;\r\n        \r\n        this._emptyTip = this._history.getChildByName(\"emptyTip\");\r\n        this._emptyTip.active = true;\r\n        \r\n        this._viewlist = this._history.getChildByName(\"viewlist\");\r\n        this._content = cc.find(\"view/content\",this._viewlist);\r\n        \r\n        this._viewitemTemp = this._content.children[0];\r\n        this._content.removeChild(this._viewitemTemp);\r\n\r\n        var node = cc.find(\"Canvas/btn_zhanji\");        \r\n        this.addClickEvent(node,this.node,\"History\",\"onBtnHistoryClicked\");\r\n        \r\n        var node = cc.find(\"Canvas/history/btn_back\");  \r\n        this.addClickEvent(node,this.node,\"History\",\"onBtnBackClicked\");\r\n    },\r\n    \r\n    addClickEvent:function(node,target,component,handler){\r\n        var eventHandler = new cc.Component.EventHandler();\r\n        eventHandler.target = target;\r\n        eventHandler.component = component;\r\n        eventHandler.handler = handler;\r\n\r\n        var clickEvents = node.getComponent(cc.Button).clickEvents;\r\n        clickEvents.push(eventHandler);\r\n    },\r\n    \r\n    onBtnBackClicked:function(){\r\n        if(this._curRoomInfo == null){\r\n            this._historyData = null;\r\n            this._history.active = false;            \r\n        }\r\n        else{\r\n            this.initRoomHistoryList(this._historyData);   \r\n        }\r\n    },\r\n    \r\n    onBtnHistoryClicked:function(){\r\n        this._history.active = true;\r\n        var self = this;\r\n        cc.vv.userMgr.getHistoryList(function(data){\r\n            data.sort(function(a,b){\r\n                return a.time < b.time; \r\n            });\r\n            self._historyData = data;\r\n            for(var i = 0; i < data.length; ++i){\r\n                for(var j = 0; j < 4; ++j){\r\n                    var s = data[i].seats[j];\r\n                    s.name = new Buffer(s.name,'base64').toString();\r\n                }\r\n            }\r\n            self.initRoomHistoryList(data);\r\n        });\r\n    },\r\n    \r\n    dateFormat:function(time){\r\n        var date = new Date(time);\r\n        var datetime = \"{0}-{1}-{2} {3}:{4}:{5}\";\r\n        var year = date.getFullYear();\r\n        var month = date.getMonth() + 1;\r\n        month = month >= 10? month : (\"0\"+month);\r\n        var day = date.getDate();\r\n        day = day >= 10? day : (\"0\"+day);\r\n        var h = date.getHours();\r\n        h = h >= 10? h : (\"0\"+h);\r\n        var m = date.getMinutes();\r\n        m = m >= 10? m : (\"0\"+m);\r\n        var s = date.getSeconds();\r\n        s = s >= 10? s : (\"0\"+s);\r\n        datetime = datetime.format(year,month,day,h,m,s);\r\n        return datetime;\r\n    },\r\n    \r\n    initRoomHistoryList:function(data){\r\n        for(var i = 0; i < data.length; ++i){\r\n            var node = this.getViewItem(i);\r\n            node.idx = i;\r\n            var titleId = \"\" + (i + 1);\r\n            node.getChildByName(\"title\").getComponent(cc.Label).string = titleId;\r\n            node.getChildByName(\"roomNo\").getComponent(cc.Label).string = \"房间ID:\" + data[i].id;\r\n            var datetime = this.dateFormat(data[i].time * 1000);\r\n            node.getChildByName(\"time\").getComponent(cc.Label).string = datetime;\r\n            \r\n            var btnOp = node.getChildByName(\"btnOp\");\r\n            btnOp.idx = i;\r\n            btnOp.getChildByName(\"Label\").getComponent(cc.Label).string = \"详情\";\r\n            \r\n            for(var j = 0; j < 4; ++j){\r\n                var s = data[i].seats[j];\r\n                var info = s.name + \":\" +  s.score;\r\n                //console.log(info);\r\n                node.getChildByName(\"info\" + j).getComponent(cc.Label).string = info;\r\n            }\r\n        }\r\n        this._emptyTip.active = data.length == 0;\r\n        this.shrinkContent(data.length);\r\n        this._curRoomInfo = null;\r\n    },\r\n    \r\n    initGameHistoryList:function(roomInfo,data){\r\n        data.sort(function(a,b){\r\n           return a.create_time < b.create_time; \r\n        });\r\n        for(var i = 0; i < data.length; ++i){\r\n            var node = this.getViewItem(i);\r\n            var idx = data.length - i - 1;\r\n            node.idx = idx;\r\n            var titleId = \"\" + (idx + 1);\r\n            node.getChildByName(\"title\").getComponent(cc.Label).string = titleId;\r\n            node.getChildByName(\"roomNo\").getComponent(cc.Label).string = \"房间ID:\" + roomInfo.id;\r\n            var datetime = this.dateFormat(data[i].create_time * 1000);\r\n            node.getChildByName(\"time\").getComponent(cc.Label).string = datetime;\r\n            \r\n            var btnOp = node.getChildByName(\"btnOp\");\r\n            btnOp.idx = idx; \r\n            btnOp.getChildByName(\"Label\").getComponent(cc.Label).string = \"回放\";\r\n            \r\n            var result = JSON.parse(data[i].result);\r\n            for(var j = 0; j < 4; ++j){\r\n                var s = roomInfo.seats[j];\r\n                var info = s.name + \":\" + result[j];\r\n                //console.log(info);\r\n                node.getChildByName(\"info\" + j).getComponent(cc.Label).string = info;\r\n            }\r\n        }\r\n        this.shrinkContent(data.length);\r\n        this._curRoomInfo = roomInfo;\r\n    },\r\n    \r\n    getViewItem:function(index){\r\n        var content = this._content;\r\n        if(content.childrenCount > index){\r\n            return content.children[index];\r\n        }\r\n        var node = cc.instantiate(this._viewitemTemp);\r\n        content.addChild(node);\r\n        return node;\r\n    },\r\n    shrinkContent:function(num){\r\n        while(this._content.childrenCount > num){\r\n            var lastOne = this._content.children[this._content.childrenCount -1];\r\n            this._content.removeChild(lastOne,true);\r\n        }\r\n    },\r\n    \r\n    getGameListOfRoom:function(idx){\r\n        var self = this;\r\n        var roomInfo = this._historyData[idx];        \r\n        cc.vv.userMgr.getGamesOfRoom(roomInfo.uuid,function(data){\r\n            if(data != null && data.length > 0){\r\n                self.initGameHistoryList(roomInfo,data);\r\n            }\r\n        });\r\n    },\r\n    \r\n    getDetailOfGame:function(idx){\r\n        var self = this;\r\n        var roomUUID = this._curRoomInfo.uuid;\r\n        cc.vv.userMgr.getDetailOfGame(roomUUID,idx,function(data){\r\n            data.base_info = JSON.parse(data.base_info);\r\n            data.action_records = JSON.parse(data.action_records);\r\n            cc.vv.gameNetMgr.prepareReplay(self._curRoomInfo,data);\r\n            cc.vv.replayMgr.init(data);\r\n            cc.director.loadScene(\"mjgame\"); \r\n        });\r\n    },\r\n    \r\n    onViewItemClicked:function(event){\r\n        var idx = event.target.idx;\r\n        console.log(idx);\r\n        if(this._curRoomInfo == null){\r\n            this.getGameListOfRoom(idx);\r\n        }\r\n        else{\r\n            this.getDetailOfGame(idx);      \r\n        }\r\n    },\r\n    \r\n    onBtnOpClicked:function(event){\r\n        var idx = event.target.parent.idx;\r\n        console.log(idx);\r\n        if(this._curRoomInfo == null){\r\n            this.getGameListOfRoom(idx);\r\n        }\r\n        else{\r\n            this.getDetailOfGame(idx);      \r\n        }\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}