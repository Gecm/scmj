{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\components/assets\\scripts\\components\\TimePointer.js"],"names":["cc","Class","extends","Component","properties","_arrow","_pointer","_timeLabel","_time","_alertTime","onLoad","gameChild","node","getChildByName","initPointer","getComponent","Label","string","self","on","data","vv","active","gameNetMgr","gamestate","turn","localIndex","getLocalIndex","i","children","length","update","dt","audioMgr","playSFX","pre","t","Math","ceil"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,gBAAO,IADC;AAERC,kBAAS,IAFD;AAGRC,oBAAW,IAHH;AAIRC,eAAM,CAAC,CAJC;AAKRC,oBAAW,CAAC;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdQ,KAHP;;AAoBL;AACAC,YAAQ,kBAAY;AAChB,YAAIC,YAAY,KAAKC,IAAL,CAAUC,cAAV,CAAyB,MAAzB,CAAhB;AACA,aAAKR,MAAL,GAAcM,UAAUE,cAAV,CAAyB,OAAzB,CAAd;AACA,aAAKP,QAAL,GAAgB,KAAKD,MAAL,CAAYQ,cAAZ,CAA2B,SAA3B,CAAhB;AACA,aAAKC,WAAL;;AAEA,aAAKP,UAAL,GAAkB,KAAKF,MAAL,CAAYQ,cAAZ,CAA2B,SAA3B,EAAsCE,YAAtC,CAAmDf,GAAGgB,KAAtD,CAAlB;AACA,aAAKT,UAAL,CAAgBU,MAAhB,GAAyB,IAAzB;;AAEA,YAAIC,OAAO,IAAX;;AAEA,aAAKN,IAAL,CAAUO,EAAV,CAAa,YAAb,EAA0B,UAASC,IAAT,EAAc;AACpCF,iBAAKJ,WAAL;AACH,SAFD;;AAIA,aAAKF,IAAL,CAAUO,EAAV,CAAa,aAAb,EAA2B,UAASC,IAAT,EAAc;AACrCF,iBAAKJ,WAAL;AACAI,iBAAKV,KAAL,GAAa,EAAb;AACAU,iBAAKT,UAAL,GAAkB,CAAlB;AACH,SAJD;AAKH,KAzCI;;AA2CLK,iBAAY,uBAAU;AAClB,YAAGd,GAAGqB,EAAH,IAAS,IAAZ,EAAiB;AACb;AACH;AACD,aAAKhB,MAAL,CAAYiB,MAAZ,GAAqBtB,GAAGqB,EAAH,CAAME,UAAN,CAAiBC,SAAjB,IAA8B,SAAnD;AACA,YAAG,CAAC,KAAKnB,MAAL,CAAYiB,MAAhB,EAAuB;AACnB;AACH;AACD,YAAIG,OAAOzB,GAAGqB,EAAH,CAAME,UAAN,CAAiBE,IAA5B;AACA,YAAIC,aAAa1B,GAAGqB,EAAH,CAAME,UAAN,CAAiBI,aAAjB,CAA+BF,IAA/B,CAAjB;AACA,aAAI,IAAIG,IAAI,CAAZ,EAAeA,IAAI,KAAKtB,QAAL,CAAcuB,QAAd,CAAuBC,MAA1C,EAAkD,EAAEF,CAApD,EAAsD;AAClD,iBAAKtB,QAAL,CAAcuB,QAAd,CAAuBD,CAAvB,EAA0BN,MAA1B,GAAmCM,KAAKF,UAAxC;AACH;AACJ,KAxDI;;AA0DL;AACAK,YAAQ,gBAAUC,EAAV,EAAc;AAClB,YAAG,KAAKxB,KAAL,GAAa,CAAhB,EAAkB;AACd,iBAAKA,KAAL,IAAcwB,EAAd;AACA,gBAAG,KAAKvB,UAAL,GAAkB,CAAlB,IAAuB,KAAKD,KAAL,GAAa,KAAKC,UAA5C,EAAuD;AACnDT,mBAAGqB,EAAH,CAAMY,QAAN,CAAeC,OAAf,CAAuB,kBAAvB;AACA,qBAAKzB,UAAL,GAAkB,CAAC,CAAnB;AACH;AACD,gBAAI0B,MAAM,EAAV;AACA,gBAAG,KAAK3B,KAAL,GAAa,CAAhB,EAAkB;AACd,qBAAKA,KAAL,GAAa,CAAb;AACH;;AAED,gBAAI4B,IAAIC,KAAKC,IAAL,CAAU,KAAK9B,KAAf,CAAR;AACA,gBAAG4B,IAAI,EAAP,EAAU;AACND,sBAAM,GAAN;AACH;AACD,iBAAK5B,UAAL,CAAgBU,MAAhB,GAAyBkB,MAAMC,CAA/B;AACH;AACJ;AA7EI,CAAT","file":"TimePointer.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _arrow:null,\r\n        _pointer:null,\r\n        _timeLabel:null,\r\n        _time:-1,\r\n        _alertTime:-1,\r\n        // foo: {\r\n        //    default: null,\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        var gameChild = this.node.getChildByName(\"game\");\r\n        this._arrow = gameChild.getChildByName(\"arrow\");\r\n        this._pointer = this._arrow.getChildByName(\"pointer\");\r\n        this.initPointer();\r\n        \r\n        this._timeLabel = this._arrow.getChildByName(\"lblTime\").getComponent(cc.Label);\r\n        this._timeLabel.string = \"00\";\r\n        \r\n        var self = this;\r\n        \r\n        this.node.on('game_begin',function(data){\r\n            self.initPointer();\r\n        });\r\n        \r\n        this.node.on('game_chupai',function(data){\r\n            self.initPointer();\r\n            self._time = 10;\r\n            self._alertTime = 3;\r\n        });\r\n    }, \r\n    \r\n    initPointer:function(){\r\n        if(cc.vv == null){\r\n            return;\r\n        }\r\n        this._arrow.active = cc.vv.gameNetMgr.gamestate == \"playing\";\r\n        if(!this._arrow.active){\r\n            return;\r\n        }\r\n        var turn = cc.vv.gameNetMgr.turn;\r\n        var localIndex = cc.vv.gameNetMgr.getLocalIndex(turn);\r\n        for(var i = 0; i < this._pointer.children.length; ++i){\r\n            this._pointer.children[i].active = i == localIndex;\r\n        }\r\n    },\r\n    \r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n        if(this._time > 0){\r\n            this._time -= dt;\r\n            if(this._alertTime > 0 && this._time < this._alertTime){\r\n                cc.vv.audioMgr.playSFX(\"timeup_alarm.mp3\");\r\n                this._alertTime = -1;\r\n            }\r\n            var pre = \"\";\r\n            if(this._time < 0){\r\n                this._time = 0;\r\n            }\r\n            \r\n            var t = Math.ceil(this._time);\r\n            if(t < 10){\r\n                pre = \"0\";\r\n            }\r\n            this._timeLabel.string = pre + t; \r\n        }\r\n    },\r\n});\r\n"]}