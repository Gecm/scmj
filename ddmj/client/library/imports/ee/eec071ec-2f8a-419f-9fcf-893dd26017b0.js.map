{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\components/assets\\scripts\\components\\CreateRoom.js"],"names":["cc","Class","extends","Component","properties","_difenxuanze","_zimo","_wanfaxuanze","_zuidafanshu","_jushuxuanze","_dianganghua","_leixingxuanze","onLoad","t","node","getChildByName","i","childrenCount","n","children","getComponent","push","onBtnBack","active","onBtnOK","createRoom","self","onCreate","ret","errcode","vv","wc","hide","alert","show","gameNetMgr","connectGameServer","difen","length","checked","zimo","huansanzhang","jiangdui","menqing","tiandihu","type","zuidafanshu","jushuxuanze","dianganghua","conf","data","account","userMgr","sign","JSON","stringify","console","log","http","sendRequest"],"mappings":"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","file":"CreateRoom.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        _difenxuanze:null,\r\n        _zimo:null,\r\n        _wanfaxuanze:null,\r\n        _zuidafanshu:null,\r\n        _jushuxuanze:null,\r\n        _dianganghua:null,\r\n        _leixingxuanze:null,\r\n    \r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        //得到3种玩法\r\n        this._leixingxuanze = [];\r\n        var t = this.node.getChildByName(\"leixingxuanze\");\r\n        for(var i = 0; i < t.childrenCount; ++i){\r\n            var n = t.children[i].getComponent(\"RadioButton\");\r\n            if(n != null){\r\n                this._leixingxuanze.push(n);\r\n            }\r\n        }\r\n        //得分选择不知道在哪里用到了\r\n        this._difenxuanze = [];\r\n        var t = this.node.getChildByName(\"difenxuanze\");\r\n        for(var i = 0; i < t.childrenCount; ++i){\r\n            var n = t.children[i].getComponent(\"RadioButton\");\r\n            if(n != null){\r\n                this._difenxuanze.push(n);\r\n            }\r\n        }\r\n        //console.log(this._difenxuanze);\r\n        \r\n        this._zimo = [];\r\n        var t = this.node.getChildByName(\"zimojiacheng\");\r\n        for(var i = 0; i < t.childrenCount; ++i){\r\n            var n = t.children[i].getComponent(\"RadioButton\");\r\n            if(n != null){\r\n                this._zimo.push(n);\r\n            }\r\n        }\r\n        //console.log(this._zimo);\r\n        \r\n        this._wanfaxuanze = [];\r\n        var t = this.node.getChildByName(\"wanfaxuanze\");\r\n        for(var i = 0; i < t.childrenCount; ++i){\r\n            var n = t.children[i].getComponent(\"CheckBox\");\r\n            if(n != null){\r\n                this._wanfaxuanze.push(n);\r\n            }\r\n        }\r\n        //console.log(this._wanfaxuanze);\r\n        \r\n        this._zuidafanshu = [];\r\n        var t = this.node.getChildByName(\"zuidafanshu\");\r\n        for(var i = 0; i < t.childrenCount; ++i){\r\n            var n = t.children[i].getComponent(\"RadioButton\");\r\n            if(n != null){\r\n                this._zuidafanshu.push(n);\r\n            }\r\n        }\r\n        //console.log(this._zuidafanshu);\r\n        \r\n        this._jushuxuanze = [];\r\n        var t = this.node.getChildByName(\"xuanzejushu\");\r\n        for(var i = 0; i < t.childrenCount; ++i){\r\n            var n = t.children[i].getComponent(\"RadioButton\");\r\n            if(n != null){\r\n                this._jushuxuanze.push(n);\r\n            }\r\n        }\r\n        \r\n        this._dianganghua = [];\r\n        var t = this.node.getChildByName(\"dianganghua\");\r\n        for(var i = 0; i < t.childrenCount; ++i){\r\n            var n = t.children[i].getComponent(\"RadioButton\");\r\n            if(n != null){\r\n                this._dianganghua.push(n);\r\n            }\r\n        }\r\n        //console.log(this._jushuxuanze);\r\n    },\r\n    //onlode方法一直到这里\r\n    onBtnBack:function(){\r\n        this.node.active = false;\r\n    },\r\n    \r\n    onBtnOK:function(){\r\n        this.node.active = false;\r\n        this.createRoom();\r\n    },\r\n   //创建房间的方法 \r\n    createRoom:function(){\r\n        var self = this;\r\n        var onCreate = function(ret){\r\n            if(ret.errcode !== 0){\r\n                cc.vv.wc.hide();\r\n                //console.log(ret.errmsg);\r\n                if(ret.errcode == 2222){\r\n                    cc.vv.alert.show(\"提示\",\"房卡不足，创建房间失败!\");  \r\n                }\r\n                else{\r\n                    cc.vv.alert.show(\"提示\",\"创建房间失败,错误码:\" + ret.errcode);\r\n                }\r\n            }\r\n            else{\r\n                //ret是包装的用户信息这是已经Roommgr服务返回ret\r\n                cc.vv.gameNetMgr.connectGameServer(ret);\r\n            }\r\n        };\r\n        //底分是0\r\n        var difen = 0;\r\n        for(var i = 0; i < self._difenxuanze.length; ++i){\r\n            if(self._difenxuanze[i].checked){\r\n                difen = i;\r\n                break;\r\n            }\r\n        }\r\n        //自摸加底，自摸加翻\r\n        var zimo = 0;\r\n        for(var i = 0; i < self._zimo.length; ++i){\r\n            if(self._zimo[i].checked){\r\n                zimo = i;\r\n                break;\r\n            }     \r\n        }\r\n       //胡牌规则\r\n        var huansanzhang = self._wanfaxuanze[0].checked;        \r\n        var jiangdui = self._wanfaxuanze[1].checked;\r\n        var menqing = self._wanfaxuanze[2].checked;\r\n        var tiandihu = self._wanfaxuanze[3].checked;\r\n        \r\n        var type = 0;\r\n        //选择麻将规则血战到底和血流成河\r\n        for(var i = 0; i < self._leixingxuanze.length; ++i){\r\n            if(self._leixingxuanze[i].checked){\r\n                type = i;\r\n                break;\r\n            }     \r\n        }\r\n        \r\n        if(type == 0){\r\n            type = \"xzdd\";\r\n        }\r\n        // else {\r\n        //     type = \"xlch\";\r\n        // }\r\n        else if(type == 1){\r\n            type = \"xlch\";\r\n        }\r\n        else {\r\n            type = \"rzmj\";\r\n        }\r\n        //最大翻数\r\n        var zuidafanshu = 0;\r\n        for(var i = 0; i < self._zuidafanshu.length; ++i){\r\n            if(self._zuidafanshu[i].checked){\r\n                zuidafanshu = i;\r\n                break;\r\n            }     \r\n        }\r\n        \r\n        //局数选择\r\n        var jushuxuanze = 0;\r\n        for(var i = 0; i < self._jushuxuanze.length; ++i){\r\n            if(self._jushuxuanze[i].checked){\r\n                jushuxuanze = i;\r\n                break;\r\n            }     \r\n        }\r\n        //点杠花连个模式\r\n        var dianganghua = 0;\r\n        for(var i = 0; i < self._dianganghua.length; ++i){\r\n            if(self._dianganghua[i].checked){\r\n                dianganghua = i;\r\n                break;\r\n            }     \r\n        }\r\n        //他们用conf记录\r\n        if(type!='rzmj'){\r\n             \r\n            var conf = {\r\n            type:type,\r\n            difen:difen,\r\n            zimo:zimo,\r\n            jiangdui:jiangdui,\r\n            huansanzhang:huansanzhang,\r\n            zuidafanshu:zuidafanshu,\r\n            jushuxuanze:jushuxuanze,\r\n            dianganghua:dianganghua,\r\n            menqing:menqing,\r\n            tiandihu:tiandihu,   \r\n            }; \r\n        }\r\n        else{\r\n            var conf={\r\n                type:type,\r\n                difen:difen,            \r\n                jushuxuanze:jushuxuanze,\r\n                zuidafanshu:zuidafanshu,\r\n            };\r\n        }\r\n       \r\n        //date 记录数据和类型\r\n        var data = {\r\n            //用户玩家\r\n            account:cc.vv.userMgr.account,\r\n            //类型\r\n            sign:cc.vv.userMgr.sign,\r\n            //选择的玩法类型\r\n            conf:JSON.stringify(conf)\r\n        };\r\n        console.log(data);\r\n        cc.vv.wc.show(\"正在创建房间\");\r\n        //一直到这里还是http请求，大厅服务器的client_server.js发消息，然后回调onCreat函数，通过服务消息gameNetMgr转发scoket服务\r\n        cc.vv.http.sendRequest(\"/create_private_room\",data,onCreate);   \r\n    }\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}