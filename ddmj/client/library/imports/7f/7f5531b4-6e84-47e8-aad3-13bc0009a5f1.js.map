{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\components/assets\\scripts\\components\\ReConnect.js"],"names":["cc","Class","extends","Component","properties","_reconnect","_lblTip","_lastPing","onLoad","find","getComponent","Label","self","fnTestServerOn","vv","net","test","ret","director","loadScene","setTimeout","fn","data","node","off","active","console","log","on","update","dt","t","Math","floor","Date","now","string","i"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAC,oBAAW,IAXH;AAYRC,iBAAQ,IAZA;AAaRC,mBAAU;AAbF,KAHP;;AAmBL;AACAC,YAAQ,kBAAY;AAChB,aAAKH,UAAL,GAAkBL,GAAGS,IAAH,CAAQ,kBAAR,CAAlB;AACA,aAAKH,OAAL,GAAeN,GAAGS,IAAH,CAAQ,sBAAR,EAAgCC,YAAhC,CAA6CV,GAAGW,KAAhD,CAAf;AACA,YAAIC,OAAO,IAAX;;AAEA,YAAIC,iBAAiB,SAAjBA,cAAiB,GAAU;AAC3Bb,eAAGc,EAAH,CAAMC,GAAN,CAAUC,IAAV,CAAe,UAASC,GAAT,EAAa;AACzB,oBAAGA,GAAH,EAAO;AACFjB,uBAAGkB,QAAH,CAAYC,SAAZ,CAAsB,MAAtB;AACJ,iBAFD,MAGI;AACAC,+BAAWP,cAAX,EAA0B,IAA1B;AACH;AACH,aAPD;AAQH,SATD;;AAWA,YAAIQ,KAAK,SAALA,EAAK,CAASC,IAAT,EAAc;AACnBV,iBAAKW,IAAL,CAAUC,GAAV,CAAc,YAAd,EAA2BH,EAA3B;AACAT,iBAAKP,UAAL,CAAgBoB,MAAhB,GAAyB,IAAzB;AACAZ;AACH,SAJD;AAKAa,gBAAQC,GAAR,CAAY,eAAZ;AACA,aAAKJ,IAAL,CAAUK,EAAV,CAAa,YAAb,EAA0BP,EAA1B;AACH,KA3CI;AA4CL;AACAQ,YAAQ,gBAAUC,EAAV,EAAc;AAClB,YAAG,KAAKzB,UAAL,CAAgBoB,MAAnB,EAA0B;AACtB,gBAAIM,IAAIC,KAAKC,KAAL,CAAWC,KAAKC,GAAL,KAAa,IAAxB,IAAgC,CAAxC;AACA,iBAAK7B,OAAL,CAAa8B,MAAb,GAAsB,iBAAtB;AACA,iBAAI,IAAIC,IAAI,CAAZ,EAAeA,IAAIN,CAAnB,EAAsB,EAAGM,CAAzB,EAA2B;AACvB,qBAAK/B,OAAL,CAAa8B,MAAb,IAAuB,GAAvB;AACH;AACJ;AACJ;AArDI,CAAT","file":"ReConnect.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        _reconnect:null,\r\n        _lblTip:null,\r\n        _lastPing:0,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._reconnect = cc.find(\"Canvas/reconnect\");\r\n        this._lblTip = cc.find(\"Canvas/reconnect/tip\").getComponent(cc.Label);\r\n        var self = this;\r\n        \r\n        var fnTestServerOn = function(){\r\n            cc.vv.net.test(function(ret){\r\n               if(ret){\r\n                    cc.director.loadScene('hall');                \r\n               }\r\n               else{\r\n                   setTimeout(fnTestServerOn,3000);\r\n               }\r\n            });\r\n        }\r\n        \r\n        var fn = function(data){\r\n            self.node.off('disconnect',fn);\r\n            self._reconnect.active = true;\r\n            fnTestServerOn();\r\n        };\r\n        console.log(\"adasfdasdfsdf\");\r\n        this.node.on('disconnect',fn);\r\n    },\r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n        if(this._reconnect.active){\r\n            var t = Math.floor(Date.now() / 1000) % 4;\r\n            this._lblTip.string = \"与服务器断开连接，正在尝试重连\";\r\n            for(var i = 0; i < t; ++ i){\r\n                this._lblTip.string += '.';\r\n            }\r\n        }\r\n    },\r\n});\r\n"]}