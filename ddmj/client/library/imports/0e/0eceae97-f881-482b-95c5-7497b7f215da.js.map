{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\MahjongMgr.js"],"names":["mahjongSprites","cc","Class","extends","Component","properties","leftAtlas","default","type","SpriteAtlas","rightAtlas","bottomAtlas","bottomFoldAtlas","pengPrefabSelf","Prefab","pengPrefabLeft","emptyAtlas","holdsEmpty","SpriteFrame","_sides","_pres","_foldPres","onLoad","vv","mahjongmgr","i","push","getMahjongSpriteByID","id","getMahjongType","getSpriteFrameByMJID","pre","mjid","spriteFrameName","getSpriteFrame","getAudioURLByMJID","realId","getEmptySpriteFrame","side","getHoldsEmptySpriteFrame","sortMJ","mahjongs","dingque","self","sort","a","b","t1","t2","getSide","localIndex","getPre","getFoldPre"],"mappings":"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","file":"MahjongMgr.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["var mahjongSprites = [];\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        //这是麻将的图集\r\n        leftAtlas:{\r\n            default:null,\r\n            type:cc.SpriteAtlas\r\n        },\r\n        \r\n        rightAtlas:{\r\n            default:null,\r\n            type:cc.SpriteAtlas\r\n        },\r\n        \r\n        bottomAtlas:{\r\n            default:null,\r\n            type:cc.SpriteAtlas\r\n        },\r\n        \r\n        bottomFoldAtlas:{\r\n            default:null,\r\n            type:cc.SpriteAtlas\r\n        },\r\n        //这是自己碰的节点的prefab\r\n        pengPrefabSelf:{\r\n            default:null,\r\n            type:cc.Prefab\r\n        },\r\n       //这是自左右碰的节点的prefab\r\n        pengPrefabLeft:{\r\n            default:null,\r\n            type:cc.Prefab\r\n        },\r\n        //这是暗牌的图集\r\n        emptyAtlas:{\r\n            default:null,\r\n            type:cc.SpriteAtlas\r\n        },\r\n        //其余玩家的牌摆放方式\r\n        holdsEmpty:{\r\n            default:[],\r\n            type:[cc.SpriteFrame]\r\n        },\r\n        \r\n        _sides:null,\r\n        _pres:null,\r\n        _foldPres:null,\r\n    },\r\n    \r\n    onLoad:function(){\r\n        if(cc.vv == null){\r\n            return;\r\n        }\r\n        this._sides = [\"myself\",\"right\",\"up\",\"left\"];//存放的四个玩家\r\n        this._pres = [\"M_\",\"R_\",\"B_\",\"L_\"];//代表四个位置\r\n        this._foldPres = [\"B_\",\"R_\",\"B_\",\"L_\"];\r\n        cc.vv.mahjongmgr = this; \r\n        //筒0-8\r\n        for(var i = 1; i < 10; ++i){\r\n            mahjongSprites.push(\"dot_\" + i);        \r\n        }\r\n        \r\n        //条9-17\r\n        for(var i = 1; i < 10; ++i){\r\n            mahjongSprites.push(\"bamboo_\" + i);\r\n        }\r\n        \r\n        //万18-26\r\n        for(var i = 1; i < 10; ++i){\r\n            mahjongSprites.push(\"character_\" + i);\r\n        }\r\n        \r\n        //中、发、白27-29\r\n        mahjongSprites.push(\"red\");\r\n        mahjongSprites.push(\"green\");\r\n        mahjongSprites.push(\"white\");\r\n        \r\n        //东西南北风30-33\r\n        mahjongSprites.push(\"wind_east\");\r\n        mahjongSprites.push(\"wind_west\");\r\n        mahjongSprites.push(\"wind_south\");\r\n        mahjongSprites.push(\"wind_north\");\r\n    },\r\n    \r\n    getMahjongSpriteByID:function(id){\r\n        return mahjongSprites[id];\r\n    },\r\n    \r\n    getMahjongType:function(id){\r\n      if(id >= 0 && id < 9){\r\n          return 0;\r\n      }\r\n      else if(id >= 9 && id < 18){\r\n          return 1;\r\n      }\r\n      else if(id >= 18 && id < 27){\r\n          return 2;\r\n      }\r\n      //再增加中发白\r\n      else if(id >= 27 && id <30){\r\n         return 3;\r\n      }\r\n      //东南西北\r\n       else if(id >= 30 && id <34){\r\n         return 4;\r\n      }\r\n    },\r\n    \r\n    getSpriteFrameByMJID:function(pre,mjid){\r\n        var spriteFrameName = this.getMahjongSpriteByID(mjid);\r\n        spriteFrameName = pre + spriteFrameName;\r\n        if(pre == \"M_\"){\r\n            return this.bottomAtlas.getSpriteFrame(spriteFrameName);            \r\n        }\r\n        else if(pre == \"B_\"){\r\n            return this.bottomFoldAtlas.getSpriteFrame(spriteFrameName);\r\n        }\r\n        else if(pre == \"L_\"){\r\n            return this.leftAtlas.getSpriteFrame(spriteFrameName);\r\n        }\r\n        else if(pre == \"R_\"){\r\n            return this.rightAtlas.getSpriteFrame(spriteFrameName);\r\n        }\r\n    },\r\n    \r\n    getAudioURLByMJID:function(id){\r\n        var realId = 0;\r\n        if(id >= 0 && id < 9){\r\n            realId = id + 21;\r\n        }\r\n        else if(id >= 9 && id < 18){\r\n            realId = id - 8;\r\n        }\r\n        else if(id >= 18 && id < 27){\r\n            realId = id - 7;\r\n        }\r\n        return \"nv/\" + realId + \".mp3\";\r\n    },\r\n    \r\n    getEmptySpriteFrame:function(side){\r\n        if(side == \"up\"){\r\n            return this.emptyAtlas.getSpriteFrame(\"e_mj_b_up\");\r\n        }   \r\n        else if(side == \"myself\"){\r\n            return this.emptyAtlas.getSpriteFrame(\"e_mj_b_bottom\");\r\n        }\r\n        else if(side == \"left\"){\r\n            return this.emptyAtlas.getSpriteFrame(\"e_mj_b_left\");\r\n        }\r\n        else if(side == \"right\"){\r\n            return this.emptyAtlas.getSpriteFrame(\"e_mj_b_right\");\r\n        }\r\n    },\r\n    \r\n    getHoldsEmptySpriteFrame:function(side){\r\n        if(side == \"up\"){\r\n            return this.emptyAtlas.getSpriteFrame(\"e_mj_up\");\r\n        }   \r\n        else if(side == \"myself\"){\r\n            return null;\r\n        }\r\n        else if(side == \"left\"){\r\n            return this.emptyAtlas.getSpriteFrame(\"e_mj_left\");\r\n        }\r\n        else if(side == \"right\"){\r\n            return this.emptyAtlas.getSpriteFrame(\"e_mj_right\");\r\n        }\r\n    },\r\n    \r\n    sortMJ:function(mahjongs,dingque){\r\n        var self = this;\r\n        mahjongs.sort(function(a,b){\r\n            if(dingque >= 0){\r\n                var t1 = self.getMahjongType(a);\r\n                var t2 = self.getMahjongType(b);\r\n                if(t1 != t2){\r\n                    if(dingque == t1){\r\n                        return 1;\r\n                    }\r\n                    else if(dingque == t2){\r\n                        return -1;\r\n                    }\r\n                }\r\n            }\r\n            return a - b;\r\n        });\r\n    },\r\n    \r\n    getSide:function(localIndex){\r\n        return this._sides[localIndex];\r\n    },\r\n    \r\n    getPre:function(localIndex){\r\n        return this._pres[localIndex];\r\n    },\r\n    \r\n    getFoldPre:function(localIndex){\r\n        return this._foldPres[localIndex];\r\n    }\r\n});\r\n"]}